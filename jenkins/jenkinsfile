pipeline {
    agent any
    environment { 
        DATABASE_URI = credentials ('DATABASE_URI')
        SECRET_KEY = credentials('SECRET_KEY')
        DOCKER_LOGIN = credentials ('DOCKER_LOGIN')


    }
    stages {
        stage('Test') {
            steps { 
                sh 'bash jenkins/test.sh'
            }
        }
        stage('Setup Docker'){
            steps {
                sh 'bash jenkins/setup-docker.sh'
            }

        }
        stage('build') {
            steps {
                sh 'docker-build -t absgeorge/serviceone'
                sh 'docker-build -t absgeorge/servicetwo'
                sh 'docker-build -t absgeorge/servicethree'
                sh 'docker-build -t absgeorge/servicefour'
            }
        }
        stage('push') {
            steps {
                sh 'docker psuh absgeorge/serviceone:latest'
                sh 'docker psuh absgeorge/servicetwo:latest'
                sh 'docker psuh absgeorge/servicethree:latest'
                sh 'docker psuh absgeorge/servicefour:latest'
        }
        stage('configurations with ansible (dockerswarm, Nginx,template') {
            steps {
                //
            }
        }
        stage('deploy') {
            steps {
                //
           }
        }
    
    }
    post{
        // publish junit cobertura reports 
    }

}